<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rarity Slot Machine with Chat</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #2d2d2d; 
            color: white;
            text-align: center;
        }
        .container { 
            margin-top: 20px;
        }
        #spinner {
            width: 80%;
            margin: 0 auto;
            height: 50px;
            background-color: #333;
            display: flex;
            justify-content: space-evenly;
            align-items: center;
            font-size: 18px;
            color: white;
            font-weight: bold;
            position: relative;
        }
        .slot-text {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0;
        }
        .active {
            animation: fadeInOut 1s ease-out forwards;
        }
        button {
            background-color: #ff6600;
            padding: 15px 30px;
            font-size: 18px;
            margin-top: 20px;
            cursor: pointer;
            border: none;
            color: white;
            border-radius: 5px;
        }
        button:disabled {
            background-color: gray;
        }
        #live-board {
            margin-top: 50px;
            padding: 10px;
            background-color: #444;
            border-radius: 10px;
            display: inline-block;
            width: 80%;
            color: white;
        }
        #result {
            font-size: 24px;
            font-weight: bold;
        }
        #chat {
            margin-top: 20px;
            padding: 10px;
            background-color: #444;
            border-radius: 10px;
            width: 80%;
            height: 200px;
            overflow-y: scroll;
            color: white;
        }
        #messageInput {
            width: 70%;
            padding: 10px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
        }
        #sendBtn {
            background-color: #ff6600;
            padding: 10px 20px;
            cursor: pointer;
            border: none;
            color: white;
            font-size: 16px;
            border-radius: 5px;
        }
        @keyframes fadeInOut {
            0% { opacity: 0; }
            50% { opacity: 1; }
            100% { opacity: 0; }
        }
    </style>
</head>
<body>
    <h1>Rarity Slot Machine with Chat</h1>
    <div id="spinner" class="container">
        <div class="slot-text" id="slotText">Failure</div>
    </div>
    <button id="spinBtn" onclick="spinMachine()">Spin (Admin Only)</button>
    <div id="live-board">
        <h2>Live Results</h2>
        <div id="result"></div>
    </div>

    <!-- Chat Section -->
    <div id="chat">
        <div id="messages"></div>
    </div>
    <input type="text" id="messageInput" placeholder="Enter message" />
    <button id="sendBtn" onclick="sendMessage()">Send</button>

    <audio id="spinSound" src="spin-sound.mp3" preload="auto"></audio>
    <audio id="winSound" src="win-sound.mp3" preload="auto"></audio>

    <script>
        const options = [
            { name: "Standard Issue", chance: 0 },
            { name: "Uncommon Issue", chance: 5 },
            { name: "Master-Crafted", chance: 10 },
            { name: "Extraordinary Master-Crafted", chance: 15 },
            { name: "Artificer", chance: 25 },
            { name: "Artifact", chance: 30 },
            { name: "Ancient Relic", chance: 35 },
            { name: "Extraordinary Relic", chance: 35 }
        ];

        const adminID = "jjreal123";  // Admin ID set here
        let isSpinning = false;
        let username = generateUsername();

        // Function to generate random usernames
        function generateUsername() {
            const adjectives = ["Mighty", "Stealthy", "Brave", "Swift", "Ancient", "Relentless"];
            const nouns = ["Dragon", "Knight", "Warrior", "Mage", "Assassin", "Archer"];
            const randomAdj = adjectives[Math.floor(Math.random() * adjectives.length)];
            const randomNoun = nouns[Math.floor(Math.random() * nouns.length)];
            return randomAdj + " " + randomNoun;
        }

        function isAdmin() {
            return prompt("Enter admin ID:") === adminID;
        }

        function getRandomItem() {
            let totalWeight = options.reduce((sum, opt) => sum + opt.chance, 0);
            let rand = Math.random() * totalWeight;
            let cumulative = 0;
            for (let option of options) {
                cumulative += option.chance;
                if (rand < cumulative) return option;
            }
            return options[options.length - 1];
        }

        function spinMachine() {
            if (isSpinning) return;
            if (!isAdmin()) {
                alert("You are not authorized to spin the machine!");
                return;
            }

            isSpinning = true;
            document.getElementById("spinBtn").disabled = true;
            document.getElementById("spinSound").play();
            const slotText = document.getElementById("slotText");
            let spinInterval = setInterval(() => {
                slotText.textContent = getRandomItem().name + " - " + getRandomItem().chance + "%";
                slotText.classList.add("active");
            }, 100);

            setTimeout(() => {
                clearInterval(spinInterval);
                const result = getRandomItem();
                slotText.textContent = `${result.name} - ${result.chance}%`;
                document.getElementById("result").innerText = `Result: ${result.name} (${result.chance}%)`;
                document.getElementById("winSound").play();
                isSpinning = false;
                document.getElementById("spinBtn").disabled = false;
            }, 5000);
        }

        // Send chat message function
        function sendMessage() {
            const message = document.getElementById("messageInput").value;
            if (message.trim() !== "") {
                const chatMessage = document.createElement("div");
                chatMessage.textContent = `${username}: ${message}`;
                document.getElementById("messages").appendChild(chatMessage);
                document.getElementById("messageInput").value = "";  // Clear input
                document.getElementById("chat").scrollTop = document.getElementById("chat").scrollHeight; // Scroll to bottom
            }
        }
    </script>
</body>
</html>

